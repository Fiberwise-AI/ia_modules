{
    "name": "Multi-Agent Collaboration Pipeline",
    "description": "Agents collaborate iteratively using agentic design patterns - planner, executor, critic, and metacognition agents work together",
    "version": "1.0.0",
    "parameters": [
        {
            "name": "task",
            "schema": {"type": "string"},
            "required": true,
            "description": "The high-level task to accomplish"
        },
        {
            "name": "max_iterations",
            "schema": {"type": "integer"},
            "required": false,
            "default": 3,
            "description": "Maximum number of collaboration iterations"
        }
    ],
    "steps": [
        {
            "id": "planner",
            "name": "Planning Agent",
            "step_class": "PlanningAgentStep",
            "module": "tests.pipelines.multi_agent_collaboration.steps.planning_agent",
            "config": {
                "pattern": "planning",
                "role": "Create detailed execution plans"
            }
        },
        {
            "id": "executor",
            "name": "Execution Agent",
            "step_class": "ExecutionAgentStep",
            "module": "tests.pipelines.multi_agent_collaboration.steps.execution_agent",
            "config": {
                "pattern": "tool_use",
                "role": "Execute the plan steps"
            }
        },
        {
            "id": "critic",
            "name": "Reflection Agent",
            "step_class": "CriticAgentStep",
            "module": "tests.pipelines.multi_agent_collaboration.steps.critic_agent",
            "config": {
                "pattern": "reflection",
                "role": "Critique and provide improvement feedback"
            }
        },
        {
            "id": "metacognition",
            "name": "Metacognition Agent",
            "step_class": "MetacognitionAgentStep",
            "module": "tests.pipelines.multi_agent_collaboration.steps.metacognition_agent",
            "config": {
                "pattern": "metacognition",
                "role": "Analyze collaboration effectiveness and adjust strategy"
            }
        },
        {
            "id": "decide_continue",
            "name": "Iteration Decision",
            "step_class": "IterationDecisionStep",
            "module": "tests.pipelines.multi_agent_collaboration.steps.iteration_decision",
            "config": {
                "quality_threshold": 0.8
            }
        },
        {
            "id": "final_synthesis",
            "name": "Final Synthesis",
            "step_class": "SynthesisAgentStep",
            "module": "tests.pipelines.multi_agent_collaboration.steps.synthesis_agent",
            "config": {
                "role": "Combine all agent insights into final output"
            }
        }
    ],
    "flow": {
        "start_at": "planner",
        "paths": [
            {
                "from": "planner",
                "to": "executor",
                "condition": {"type": "always"}
            },
            {
                "from": "executor",
                "to": "critic",
                "condition": {"type": "always"}
            },
            {
                "from": "critic",
                "to": "metacognition",
                "condition": {"type": "always"}
            },
            {
                "from": "metacognition",
                "to": "decide_continue",
                "condition": {"type": "always"}
            },
            {
                "from": "decide_continue",
                "to": "planner",
                "condition": {
                    "type": "field_equals",
                    "field": "should_continue",
                    "value": true
                }
            },
            {
                "from": "decide_continue",
                "to": "final_synthesis",
                "condition": {
                    "type": "field_equals",
                    "field": "should_continue",
                    "value": false
                }
            }
        ]
    }
}
